<html>
<head>
    <title>Vue Harvest Report</title>
    
</head>
<body>
    <div id="app" v-cloak>
        <label for="report-title">Report Title:</label>
        <input type="text" id="report-title" v-model="reportTitle">
        
        <h1>Harvest Report</h1>
        <p>This is a <em>mockup</em> of the report.</p>
        <hr>
        <h1>{{ reportTitle }}</h1>
        <p>Start Date: {{ startDate }}</p>  
        <p>End Date: {{ endDate }}</p>
        <p>Selected Crop: {{ selectedCrop }}</p>
        <br>
        <p>Details</p>
        <p><strong>Farm:</strong> {{ farm }}</p>
        <p><strong>User:</strong> {{ user }}</p>
        <p><strong>Language:</strong> {{ language }}</p>

      

        <label for="crop">Crop:</label>
        <select id="crop" name="crop" v-model="selectedCrop">
            <option v-for="crop in cropNames" :key="crop" :value="crop">{{ crop }}</option>
        </select>
        
        <label for="field">Area:</label>
        <select id="field" name="field" v-model="selectedField">
            <option v-for="area in areas" :key="area" :value="area">{{ area }}</option>
        </select>

        <label for="start-date">Start Date:</label>
        <input type="date" id="start-date" v-model="startDate" :max="endDate">

        <label for="end-date">End Date:</label>
        <input type="date" id="end-date" v-model="endDate" :min="startDate">


        <ul>     
            <li><strong>Corn</strong> was seeded</li>     
            <li><strong>Broccoli</strong> was seeded</li>     
            <li><strong>Other plants</strong> was seeded</li> 
        </ul> 

        <button @click="generateReport">Generate Report</button>
        
        <div v-if="harvestLogs.length > 0">
            <table border="1">
                <thead>
                    <tr>
                        <th>Row</th>
                        <th>Date</th>
                        <th>Crop</th>
                        <th>Field</th>
                        <th>Quantity</th>
                        <th>Units</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="(log, index) in harvestLogs" :key="index">
                        <td>{{ index + 1 }}</td> 
                        <td>{{ log.date }}</td>
                        <td>{{ log.crop }}</td>
                        <td>{{ log.area }}</td>
                        <td>{{ log.yield }}</td>
                        <td>{{ log.units }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p v-else>No matching records found.</p>
        

    </div>

    <script>
      
        var app = new Vue({
            el: '#app',
            data: {
                farm: "",
                user: "",
                language: "",
                reportTitle: 'My Sample Harvest Report',
                startDate: '2020-05-05',
                endDate: '2020-05-15',
                selectedCrop: 'kale',
                selectedField: 'all',
                areas: ['All', 'Chuau-1', 'SQ7'],
                harvestLogs: [],
                idToCropMap: new Map()
            },
            computed:{
                cropNames(){
                    return this.idToCropMap.values();
                }
            },
            methods: {
                generateReport() {
                    axios.get('/farm.json')
                    .then((response) => {
                        console.log("Got Response");
                        console.log(response);
                        
                        this.farm = response.data.name;
                        this.user = response.data.user.name;
                        this.language = response.data.languages.en.name;
                    })
                    .catch((error) => {
                        console.log("Error Occurred");
                        console.log(error);
                    });

                    this.harvestLogs.push({
                        date: "2018-05-01",
                        area: "Orion-3",
                        crop: "Carrots",
                        yield: 50,
                        units: "Kg"
                    });
                },
            },
            created() {
                
                getIDToCropMap()
                    .then((theMap) => {
                        this.idToCropMap = theMap
                    })
                    .catch((err) => {
                    })
            }
        });
        Vue.config.devtools = true;

        
    </script>
</body>
</html>